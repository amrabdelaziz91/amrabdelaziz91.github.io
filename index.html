<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>GPX trackpoints and waypoints</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
 <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>

<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" /><style>
  body { margin:0; padding:0; }
  #map { position:absolute; top:0; bottom:0; width:100%; }
</style>
</head>
<body>
<script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.2.0/leaflet-omnivore.min.js'></script>
<script src='jquery-2.2.0.min.js'></script>

<div id='map'></div>
<div style="
    z-index: 9999999999;
    position: absolute;
    right: 33px;
    margin-top: 10px;
    background-color: rgba(180,186,191,0.5);
    border-radius: 10px;
    FONT-SIZE: 25px;
    font-family: monospace;
"><p style="
    margin-left: 15px;
    margin-right: 15px;
">Mohandseen Bus</p></div>
<script>
var map = L.map('map').setView([51.505, -0.09], 13);

L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);

var ajax = $.ajax({
    url : "map.geojson",
    dataType : 'json',
    success : function (response) {
       WFSLayer = L.geoJson(response,{
	   onEachFeature: function (feature, layer) {
        layer.bindPopup("<h4> <b>Arrives To </b>"+ feature.properties.landmark+" </h4><h4><b>At </b>"+ feature.properties.time+" </h4>");
    },
	pointToLayer: function(feature, latlng) {
	var imgIcon;
	if (feature.properties.landmark=="Etisalat HQ") imgIcon = "etisalat.png" ; 
	else imgIcon = "bus.png";
   var smallIcon = L.icon({
                      iconSize: [30, 35],
                      iconAnchor: [27, 27],
                      popupAnchor:  [1, -15],
                      iconUrl: imgIcon
   });

   return L.marker(latlng, {icon: smallIcon});
}
	   
	   }).addTo(map);
    }
});

// omnivore will AJAX-request this file behind the scenes and parse it:
// note that there are considerations:
// - The file must either be on the same domain as the page that requests it,
//   or both the server it is requested from and the user's browser must
//   support CORS.
var runLayer = omnivore.gpx('test.gpx')
    .on('ready', function() {
        map.fitBounds(runLayer.getBounds());
    })
    .addTo(map);
</script>
</body>
</html>